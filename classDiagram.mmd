---
config:
  layout: elk
---
classDiagram
direction TB

%% --- Core Engine Management ---
class GameMaster {
  -running: boolean
  -deltaTime: float
  -sceneManager: SceneManager
  +init(): void
  +run(): void
  +dispose(): void
}

class IManager {
  <<interface>>
  +initialize(): void
  +update(deltaTime: float): void
  +shutdown(): void
}

class SceneManager {
  -currentScene: Scene
  -scenes: Map~String, Scene~
  +addScene(name: String, scene: Scene): void
  +loadScene(name: String): void
  +unloadScene(name: String): void
  +transitionTo(name: String): void
  +getCurrentScene(): Scene
}

class Scene {
  <<abstract>>
  -name: String
  #entityManager: EntityManager
  #collisionManager: CollisionManager
  #movementManager: MovementManager
  #ioManager: IOManager
  +onEnter(): void
  +onExit(): void
  +update(deltaTime: float): void
  +render(): void
  +dispose(): void
}

%% --- Entity Component System (ECS) Core ---
class Entity {
  -id: UUID
  -active: boolean
  -components: Map~Type, Component~
  +addComponent(component: Component): void
  +removeComponent(type: Type): void
  +getComponent(type: Type): Component
  +setActive(active: boolean): void
  +isActive(): boolean
}

class EntityManager {
  -entities: List~Entity~
  -entitiesToAdd: List~Entity~
  -entitiesToRemove: List~Entity~
  +addEntity(entity: Entity): void
  +removeEntity(entity: Entity): void
  +getEntityCount(): int
  +getEntities(): List~Entity~
}

%% --- Components ---
class Component {
  <<abstract>>
  #owner: Entity
  #enabled: boolean
  +onAttach(entity: Entity): void
  +onDetach(): void
  +setEnabled(enabled: boolean): void
  +isEnabled(): boolean
}

class TransformComponent {
  +positionX: float
  +positionY: float
  +width: float
  +height: float
  +rotation: float
}

class PhysicsComponent {
  +velocityX: float
  +velocityY: float
  +mass: float
}

class CollisionComponent {
  -collisionLayer: int
  -trigger: boolean
  -boundsOffset: Vector2
  -transform: TransformComponent
  +getBounds(): Rectangle
  +onCollisionEnter(other: CollisionComponent): void
  +setCollisionLayer(layer: int): void
  +getCollisionLayer(): int
  +canCollideWith(other: CollisionComponent): boolean
  +isTrigger(): boolean
  +setTrigger(trigger: boolean): void
  +getBoundsOffset(): Vector2
  +setBoundsOffset(offset: Vector2): void
  +update(deltaTime: float): void
}

%% --- Utility Classes ---
class Vector2 {
  +x: float
  +y: float
  +Vector2()
  +Vector2(x: float, y: float)
  +set(x: float, y: float): void
  +copy(): Vector2
}

class Rectangle {
  +x: float
  +y: float
  +width: float
  +height: float
  +Rectangle(x: float, y: float, width: float, height: float)
  +overlaps(other: Rectangle): boolean
}

%% --- Managers (Systems) ---
class CollisionManager {
  -collisionComponents: List~CollisionComponent~
  +detectCollisions(): void
  +checkCollision(a: CollisionComponent, b: CollisionComponent): boolean
  #handleCollision(a: CollisionComponent, b: CollisionComponent): void
  +canCollide(a: CollisionComponent, b: CollisionComponent): boolean
  +addCollisionComponent(component: CollisionComponent): void
  +removeCollisionComponent(component: CollisionComponent): void
}

class MovementManager {
  -strategies: List~MovementStrategy~
  +addMovementStrategy(strategy: MovementStrategy): void
  +removeMovementStrategy(strategy: MovementStrategy): void
  +updateMovement(deltaTime: float): void
}

class MovementStrategy {
  <<interface>>
  +applyMovement(transform: TransformComponent, physics: PhysicsComponent, deltaTime: float): void
}

class IOManager {
  -input: InputManager
  -output: OutputManager
  +getInput(): InputManager
  +getOutput(): OutputManager
}

class InputManager {
  +isKeyPressed(key: int): boolean
  +isKeyJustPressed(key: int): boolean
  +getMousePosition(): Vector2
}

class OutputManager {
  +begin(): void
  +draw(transform: TransformComponent, renderable: Component): void
  +end(): void
  +dispose(): void
}

%% --- Relationships ---

GameMaster "1" *-- "1" SceneManager
IManager <|.. SceneManager
IManager <|.. EntityManager
IManager <|.. CollisionManager
IManager <|.. MovementManager
IManager <|.. IOManager

SceneManager "1" *-- "*" Scene : owns
GameMaster ..> SceneManager : runs

Scene "1" *-- "1" EntityManager : owns
Scene "1" *-- "1" CollisionManager : owns
Scene "1" *-- "1" MovementManager : owns
Scene "1" *-- "1" IOManager : owns

EntityManager "1" *-- "*" Entity : manages
Entity "1" *-- "*" Component : contains

Component <|-- TransformComponent
Component <|-- PhysicsComponent
Component <|-- CollisionComponent

CollisionManager ..> CollisionComponent : processes
CollisionComponent ..> Rectangle : uses
CollisionComponent ..> Vector2 : uses
CollisionComponent ..> TransformComponent : uses
MovementManager ..> TransformComponent : processes
MovementManager ..> PhysicsComponent : processes
MovementManager "1" o-- "*" MovementStrategy : uses

IOManager "1" *-- "1" InputManager
IOManager "1" *-- "1" OutputManager
