classDiagram
    %% ============================
    %% Core Engine
    %% ============================
    class GameMaster {
        -running: boolean
        -deltaTime: float
        -shapeRenderer: ShapeRenderer
        - entityManager: EntityManager         
        - collisionManager: CollisionManager   
        - movementManager: MovementManager

        +init(): void
        +update(dt: float) void
        +render() void
        +dispose() void
        +run() void
    }

    class IManager {
        <<interface>>
        +initialize()
        +update(deltaTime)
        +shutdown()
    }

    IManager <|.. SceneManagement
    IManager <|.. EntityManager
    IManager <|.. CollisionManager
    IManager <|.. MovementManager
    IManager <|.. IOManager

    %% ============================
    %% Scene Management
    %% ============================
    class SceneManagement {
        +current: Scene
        -scenes: Map<String, Scene>
        +addScene(name: String, scene)
        +loadScene(name: String) void
        +unloadScene(name: String)
        +transitionTo(name: String)
        +getCurrent() Scene
    }

    class SceneManager {
        -entities: List<Entity>
        +create(e: Entity) void
        +remove(e: Entity) void
        +getAll() List(Entity)
        +update(dt: float) void
    }

    class Scene {
        -name: String
        -entity Manager
        -collision Manager
        -io Manager
    }

    SceneManagement "1" --> "*" SceneManager
    Scene "1" --> "*" SceneManagement
    SceneManagement ..|> AbstractEngine: uses

    %% ============================
    %% Entity & Component Model
    %% ============================
    class EntityManager {
        -entities: List~Entity~
        -entitiesToAdd: List~Entity~
        -entitiesToRemove: List~Entity~
        
        +init(): void
        +update(deltaTime: float): void
        +render(batch: SpriteBatch): void
        +addEntity(entity: Entity): void
        +removeEntity(entity: Entity): void
        +getEntityCount(): int
    }

   class Entity {
        <<abstract>>
        #positionX: float
        #positionY: float
        #width: float
        #height: float
        #velocityX: float
        #velocityY: float
        #isActive: boolean
        
        +update(deltaTime: float): void
        +render(batch: SpriteBatch): void
        +dispose(): void
        +setBounds(x: float, y: float, w: float, h: float): void
        +setVelocity(vx: float, vy: float): void
        +isActive(): boolean
    }

    %% Relationship: Manager owns Entity
    EntityManager "1" *-- "*" Entity : manages

    class Component {
    <<abstract>>
    -owner: Entity
    -enabled: boolean
    
    +onAttach(entity: Entity): void
    +onDetach(): void
    +update(deltaTime: float): void
    +setEnabled(enabled: boolean): void
    +isEnabled(): boolean
}

class CollisionComponent {
    -collisionLayer: int
    -isTrigger: boolean
    -bounds: Rectangle
    
    +onAttach(entity: Entity): void
    +onDetach(): void
    +update(deltaTime: float): void
    +getBounds(): Rectangle
    +onCollisionEnter(other: CollisionComponent): void
    +onCollisionStay(other: CollisionComponent): void
    +onCollisionExit(other: CollisionComponent): void
    +getCollisionLayer(): int
    +setCollisionLayer(layer: int): void
    +canCollideWith(other: CollisionComponent): boolean
}

Component <|-- CollisionComponent : extends

    Entity "1" *-- "*" Component : composed of

    %% ============================
    %% Collision Management
    %% ============================

    class CollisionManager {
    -collidables: List<CollisionComponent>
    +detectCollisions(): void
    +checkCollision(a: CollisionComponent, b: CollisionComponent): boolean
    +resolveCollision(a: CollisionComponent, b: CollisionComponent): void
    +update(deltaTime: float): void
}

    CollisionManager ..> CollisionComponent : uses
    CollisionManager ..> Entity : queries

    %% ============================
    %% Movement Management
    %% ============================
    class MovementManager {
        -strategies: List<MovementStrategy>
        +addMovementStrategy(strategy: MovementStrategy): void
        +removeMovementStrategy(strategy: MovementStrategy): void
        +updateMovement(entities: List<Entity>, deltaTime: float): void
    }

    class MovementStrategy {
        <<interface>>
        +applyMovement(entity: Entity, deltaTime: float): void
    }

    MovementManager "1" *-- "*" MovementStrategy : uses

    %% ============================
    %% Input / Output Management
    %% ============================

    class IOManager {
        -input: InputManager
        -output: OutputManager
        +update(deltaTime: float): void
        +dispose(): void
    }

    class InputManager {
        +isKeyPressed(key: int): boolean
        +isKeyJustPressed(key: int): boolean
        +getMousePosition(): Vector2
    }

    class OutputManager {
        +begin(batch: SpriteBatch): void
        +draw(entity: Entity, batch: SpriteBatch): void
        +end(batch: SpriteBatch): void
        +dispose(): void
    }

    IOManager --> InputManager
    IOManager --> OutputManager