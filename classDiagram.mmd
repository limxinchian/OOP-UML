classDiagram
    %% ============================
    %% Core Engine
    %% ============================
    class GameMaster {
        -running: boolean
        -deltaTime: float
        -shapeRenderer: ShapeRenderer
        - entityManager: EntityManager         
        - collisionManager: CollisionManager   
        - movementManager: MovementManager

        +init(): void
        +update(dt: float) void
        +render() void
        +dispose() void
        +run() void
    }

    class IManager {
        <<interface>>
        +initialize()
        +update(deltaTime)
        +shutdown()
    }

    IManager <|.. SceneManagement
    IManager <|.. EntityManager
    IManager <|.. CollisionManager
    IManager <|.. MovementManager
    IManager <|.. IOManager

    %% ============================
    %% Scene Management
    %% ============================
    class SceneManagement {
        +current: Scene
        -scenes: Map<String, Scene>
        +addScene(name: String, scene)
        +loadScene(name: String) void
        +unloadScene(name: String)
        +transitionTo(name: String)
        +getCurrent() Scene
    }

    class SceneManager {
        -entities: List<Entity>
        +create(e: Entity) void
        +remove(e: Entity) void
        +getAll() List(Entity)
        +update(dt: float) void
    }

    class Scene {
        -name: String
        -entity Manager
        -collision Manager
        -io Manager
    }

    SceneManagement "1" --> "*" SceneManager
    Scene "1" --> "*" SceneManagement
    SceneManagement ..|> AbstractEngine: uses

    %% ============================
    %% Entity & Component Model
    %% ============================
    class EntityManager {
    -entities: List<Entity>
    
    +initialize(): void
    +update(deltaTime: float): void
    +shutdown(): void
    +addEntity(entity: Entity): void
    +removeEntity(entity: Entity): void
    +getEntityCount(): int
    +findEntitiesByType(type: Class): List<Entity>
    +getActiveEntities(): List<Entity>
    +clearAllEntities(): void
}

   class Entity {
    <<abstract>>
    -positionX: float
    -positionY: float
    -width: float
    -height: float
    -isActive: boolean
    -velocityX: float
    -velocityY: float
    -components: List<Component>
    
    +update(deltaTime: float): void
    +render(): void
    +setPosition(x: float, y: float): void
    +getPosition(): Vector2
    +setVelocity(vx: float, vy: float): void
    +getVelocity(): Vector2
    +activate(): void
    +deactivate(): void
    +isEntityActive(): boolean
    +getBounds(): Rectangle
    +addComponent(component: Component): void
    +removeComponent(component: Component): void
    +getComponent(type: Class): Component
    +hasComponent(type: Class): boolean
}

    EntityManager "1" --> "*" Entity : manages

    class Component {
    <<abstract>>
    -owner: Entity
    -enabled: boolean
    
    +onAttach(entity: Entity): void
    +onDetach(): void
    +update(deltaTime: float): void
    +setEnabled(enabled: boolean): void
    +isEnabled(): boolean
}

class CollisionComponent {
    -collisionLayer: int
    -isTrigger: boolean
    -bounds: Rectangle
    
    +onAttach(entity: Entity): void
    +onDetach(): void
    +update(deltaTime: float): void
    +getBounds(): Rectangle
    +onCollisionEnter(other: CollisionComponent): void
    +onCollisionStay(other: CollisionComponent): void
    +onCollisionExit(other: CollisionComponent): void
    +getCollisionLayer(): int
    +setCollisionLayer(layer: int): void
    +canCollideWith(other: CollisionComponent): boolean
}

Component <|-- CollisionComponent : extends

    Entity "1" *-- "*" Component : composed of

    %% ============================
    %% Collision Management
    %% ============================

    class CollisionManager {
        collidables : List
        + detectCollisions()
        + checkCollision(a, b)
        +resolveCollision(a,b)
        + update()
    }

    CollisionManager ..> CollisionComponent : uses
    CollisionManager ..> Entity : queries
    %% ============================
    %% Movement Management
    %% ============================
    class MovementManager {
        +updateMovement(entities : List, deltaTime)
    }

    MovementManager --> Entity : updates

    %% ============================
    %% Input / Output Management
    %% ============================
    class IOManager {
        +pollInput()
        +dispatchInput()
        +render()
    }

    class InputHandler {
        +getInputState()
    }

    class OutputHandler {
        +drawScene(scene : Scene)
        +playAudio()
    }

    IOManager --> InputHandler
    IOManager --> OutputHandler
